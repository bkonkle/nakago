"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[618],{5201:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>t,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var s=l(5893),c=l(1151);const i={sidebar_position:5},r="Development",a={id:"development",title:"Development",description:"To set up a development environment to build this project, you'll need to install some helpful tools.",source:"@site/docs/development.md",sourceDirName:".",slug:"/development",permalink:"/docs/development",draft:!1,unlisted:!1,editUrl:"https://github.com/bkonkle/nakago/tree/main/website/docs/development.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"documentationSidebar",previous:{title:"Examples",permalink:"/docs/examples"}},t={},d=[{value:"Clippy",id:"clippy",level:2},{value:"pre-commit",id:"pre-commit",level:2},{value:"libclang",id:"libclang",level:2},{value:"Cargo Make",id:"cargo-make",level:2},{value:"Running the Local dev server",id:"running-the-local-dev-server",level:2},{value:"Update Dependencies",id:"update-dependencies",level:2},{value:"Examples: Docker Build",id:"examples-docker-build",level:2}];function o(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,c.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"development",children:"Development"}),"\n",(0,s.jsx)(n.p,{children:"To set up a development environment to build this project, you'll need to install some helpful tools."}),"\n",(0,s.jsx)(n.h2,{id:"clippy",children:"Clippy"}),"\n",(0,s.jsxs)(n.p,{children:["For helpful linting rools, install ",(0,s.jsx)(n.a,{href:"https://github.com/rust-lang/rust-clippy",children:"Clippy"})]}),"\n",(0,s.jsxs)(n.p,{children:["Run it with ",(0,s.jsx)(n.code,{children:"cargo"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cargo clippy --fix\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If you're using VS Code, configure the ",(0,s.jsx)(n.code,{children:"rust-analyzer"})," plugin to use it (in ",(0,s.jsx)(n.em,{children:"settings.json"}),"):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "rust-analyzer.checkOnSave.command": "clippy"\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"pre-commit",children:"pre-commit"}),"\n",(0,s.jsx)(n.p,{children:"Install pre-commit to automatically set up Git hook scripts."}),"\n",(0,s.jsxs)(n.p,{children:["In Ubuntu, the package to install is ",(0,s.jsx)(n.code,{children:"pre-commit"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo apt install pre-commit\n"})}),"\n",(0,s.jsxs)(n.p,{children:["On Mac with Homebrew, the package is also ",(0,s.jsx)(n.code,{children:"pre-commit"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"brew install pre-commit\n"})}),"\n",(0,s.jsx)(n.h2,{id:"libclang",children:"libclang"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"cargo-spellcheck"})," utility depends on ",(0,s.jsx)(n.a,{href:"https://clang.llvm.org/doxygen/group__CINDEX.html",children:(0,s.jsx)(n.code,{children:"libclang"})}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["In Ubuntu, the package to install is ",(0,s.jsx)(n.code,{children:"libclang-dev"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"sudo apt install libclang-dev\n"})}),"\n",(0,s.jsx)(n.h2,{id:"cargo-make",children:"Cargo Make"}),"\n",(0,s.jsxs)(n.p,{children:["To use build scripts from the ",(0,s.jsx)(n.em,{children:"Makefile.toml"}),", install Cargo Make:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cargo install cargo-make\n"})}),"\n",(0,s.jsx)(n.p,{children:'Run "setup" to install some tooling dependencies:'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cargo make setup\n"})}),"\n",(0,s.jsx)(n.h2,{id:"running-the-local-dev-server",children:"Running the Local dev server"}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"cargo"})," to run the dev server locally:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cargo make dev\n"})}),"\n",(0,s.jsx)(n.h2,{id:"update-dependencies",children:"Update Dependencies"}),"\n",(0,s.jsxs)(n.p,{children:["First, install the ",(0,s.jsx)(n.code,{children:"outdated"})," command for ",(0,s.jsx)(n.code,{children:"cargo"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cargo install cargo-outdated\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then, update and check for any major dependency changes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"cargo update\ncargo outdated\n"})}),"\n",(0,s.jsx)(n.h2,{id:"examples-docker-build",children:"Examples: Docker Build"}),"\n",(0,s.jsx)(n.p,{children:"To build locally, use Buildkit:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"DOCKER_BUILDKIT=1 docker build -t async-graphql -f examples/async-graphql/Dockerfile .\n"})}),"\n",(0,s.jsx)(n.p,{children:"To clear the build cache:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker builder prune --filter type=exec.cachemount\n"})}),"\n",(0,s.jsx)(n.p,{children:"To inspect the local filesystem:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker run --rm -it --entrypoint=/bin/bash async-graphql\n"})}),"\n",(0,s.jsx)(n.p,{children:"To inspect the full build context:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker image build --no-cache -t build-context -f - . <<EOF\nFROM busybox\nWORKDIR /build-context\nCOPY . .\nCMD find .\nEOF\n\ndocker container run --rm build-context\n"})}),"\n",(0,s.jsx)(n.p,{children:"And to clean up the build context test image:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker image rm build-context\n"})})]})}function h(e={}){const{wrapper:n}={...(0,c.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},1151:(e,n,l)=>{l.d(n,{Z:()=>a,a:()=>r});var s=l(7294);const c={},i=s.createContext(c);function r(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:r(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);